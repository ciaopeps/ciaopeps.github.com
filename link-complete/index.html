  <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="utf-8">
    <title>AI Chef – Complete Instagram Link</title>
    <meta name="viewport" content="width=device-width, initial-
  scale=1">
    <style>
      :root { color-scheme: light; }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
  sans-serif;
        margin: 0;
        padding: 32px;
        background: #faf7f1;
        color: #2d1f16;
      }
      main {
        max-width: 520px;
        margin: 0 auto;
        background: #fff;
        border-radius: 16px;
        padding: 32px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
      }
      h1 { margin-top: 0; font-size: 28px; }
      p { line-height: 1.5; }
      code {
        font-size: 1.1em;
        background: rgba(244, 159, 10, 0.12);
        padding: 3px 6px;
        border-radius: 6px;
      }
      textarea {
        width: 100%;
        margin-top: 12px;
        font-size: 16px;
        padding: 12px;
        border-radius: 12px;
        border: 1.5px solid rgba(0,0,0,0.12);
        resize: none;
      }
      .buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-top: 24px;
      }
      button, .button-link {
        flex: 1 1 160px;
        font-size: 16px;
        padding: 12px 16px;
        border-radius: 12px;
        border: 0;
        background: #f49f0a;
        color: #fff;
        font-weight: 600;
        text-align: center;
        text-decoration: none;
        cursor: pointer;
      }
      button.secondary, .button-link.secondary {
        background: transparent;
        color: #f49f0a;
        border: 1.5px solid rgba(244, 159, 10, 0.4);
      }
      button.outline {
        background: transparent;
        color: #2d1f16;
        border: 1.5px solid rgba(0, 0, 0, 0.18);
      }
      small { color: rgba(45,31,22,0.7); }
    </style>
  </head>
  <body>
    <main>
      <h1>Almost there!</h1>
      <p>If the AI Chef app didn’t open automatically, copy this code
  and paste it into the app to finish linking Instagram.</p>

      <p><code id="code">loading…</code></p>
      <textarea id="code-text" rows="2" readonly hidden></textarea>
      <small id="copy-hint" hidden>Long‑press to select and copy if
  the Copy button doesn’t work inside Instagram.</small>

      <p id="error" hidden>
        Uh oh—there’s no verification code in this link. Make sure you
  opened the latest DM from AI Chef.
      </p>

      <p id="store-link" hidden>
        Don’t have the app installed? <a id="app-store" href="#"
  target="_blank" rel="noopener">Download AI Chef for iOS.</a>
      </p>

      <div id="actions" class="buttons" hidden>
        <button id="copy">Copy code</button>
        <button id="open-app">Open AI Chef</button>
        <a id="open-safari" class="button-link secondary"
  target="_blank" rel="noopener noreferrer">Open in Safari</a>
      </div>
    </main>

    <script>
      const params = new URLSearchParams(window.location.search);
      const rawCode = params.get('code');


      const CUSTOM_SCHEME = 'aichef://link-complete?code=';

      const codeElement = document.getElementById('code');
      const textArea = document.getElementById('code-text');
      const copyHint = document.getElementById('copy-hint');
      const actions = document.getElementById('actions');
      const error = document.getElementById('error');
      const storeLink = document.getElementById('store-link');
      const appStoreAnchor = document.getElementById('app-store');
      const copyButton = document.getElementById('copy');
      const openAppButton = document.getElementById('open-app');
      const openSafariLink = document.getElementById('open-safari');

      function enableStoreLink(url) {
        if (!url || !url.startsWith('https://')) return;
        appStoreAnchor.href = url;
        storeLink.hidden = false;
      }


      const normalizedCode = rawCode.trim().toUpperCase();
      const encodedCode = encodeURIComponent(normalizedCode);
      const universalLink = `${window.location.origin}/link-complete?
  code=${encodedCode}`;

      codeElement.textContent = normalizedCode;
      textArea.value = normalizedCode;
      textArea.hidden = false;
      copyHint.hidden = false;
      actions.hidden = false;
      openSafariLink.href = universalLink;

      copyButton.addEventListener('click', async () => {
        try {
          await navigator.clipboard.writeText(normalizedCode);
          alert('Copied! Switch back to AI Chef and paste the code.');
        } catch {
          alert('Clipboard is blocked inside Instagram. Long‑press the code field to copy manually.');
        }
      });

      openAppButton.addEventListener('click', () => {
        const appUrl = `${CUSTOM_SCHEME}${encodedCode}`;
        window.location.href = appUrl;

      });
    </script>
  </body>
  </html>
